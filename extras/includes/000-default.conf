<VirtualHost *:80>
    ServerName team.practicepractice.net
    ProxyPreserveHost On
    RewriteEngine On

    RewriteCond %{REQUEST_URI}  ^/api/v4/websocket    [NC,OR]
    RewriteCond %{HTTP:UPGRADE} ^WebSocket$           [NC,OR]
    RewriteCond %{HTTP:CONNECTION} ^Upgrade$          [NC]
    RewriteRule .* ws://0.0.0.0:8066%{REQUEST_URI}  [P,QSA,L]

    RewriteCond %{DOCUMENT_ROOT}/%{REQUEST_FILENAME} !-f
    RewriteRule .* http://0.0.0.0:8066%{REQUEST_URI} [P,QSA,L]
    RequestHeader set X-Forwarded-Proto "https"

    <Location /api/v4/websocket>
        Require all granted
        ProxyPassReverse ws://127.0.0.0:8066/api/v4/websocket
        ProxyPassReverseCookieDomain 0.0.0.0 team.practicepractice.net
    </Location>

    <Location />
        Require all granted
        ProxyPassReverse http://0.0.0.0:8066/
        ProxyPassReverseCookieDomain 0.0.0.0 team.practicepractice.net
    </Location>

    LogFormat "%{X-Forwarded-For}i %l %u %t \"%r\" %>s %b" common_forwarded
RewriteCond %{SERVER_NAME} =team.practicepractice.net
RewriteRule ^ https://%{SERVER_NAME}%{REQUEST_URI} [END,NE,R=permanent]
</VirtualHost>
#<VirtualHost *:80>
#    ServerName team.practicepractice.net
#
#    <Proxy *>
#        Order allow,deny
#        Allow from all
#    </Proxy>
#    proxyPreserveHost On
#    ProxyPass / http://0.0.0.0:8066/
#    ProxyPassReverse / http://0.0.0.0:8066/
#RewriteEngine on
#RewriteCond %{SERVER_NAME} =team.practicepractice.net
#RewriteRule ^ https://%{SERVER_NAME}%{REQUEST_URI} [END,NE,R=permanent]
#</VirtualHost>

<VirtualHost *:80>
    ServerName practicepractice.net
    ServerAlias www.practicepractice.net 

    proxyPreserveHost On
    ProxyPass / http://0.0.0.0:8005/
    ProxyPassReverse / http://0.0.0.0:8005/
RewriteEngine on
RewriteCond %{SERVER_NAME} =www.practicepractice.net [OR]
RewriteCond %{SERVER_NAME} =practicepractice.net
RewriteRule ^ https://%{SERVER_NAME}%{REQUEST_URI} [END,NE,R=permanent]
</VirtualHost>


<VirtualHost *:80>
    ServerName bakourltd.com
    ServerAlias www.bakourltd.com

    #RequestHeader set "X-Forwarded-Proto" expr=%{REQUEST_SCHEME}
    #RequestHeader set "X-Forwarded-SSL" expr=%{HTTPS}

    proxyPreserveHost On
    ProxyPass / http://0.0.0.0:8000/
    ProxyPassReverse / http://0.0.0.0:8000/
RewriteEngine on
RewriteCond %{SERVER_NAME} =www.bakourltd.com [OR]
RewriteCond %{SERVER_NAME} =bakourltd.com
RewriteRule ^ https://%{SERVER_NAME}%{REQUEST_URI} [END,NE,R=permanent]
</VirtualHost>
